This is transferred from https://github.com/tony-landis. Also,I have made some changes.
