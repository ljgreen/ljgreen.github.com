This is forked from Tony Landis:https://github.com/tony-landis. Also,I have made some changes.
